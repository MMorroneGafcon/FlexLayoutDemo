{"ast":null,"code":"\"use strict\";\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FloatingWindow = void 0;\n\nvar React = require(\"react\");\n\nvar react_dom_1 = require(\"react-dom\");\n\nvar Types_1 = require(\"../Types\");\n/** @internal */\n\n\nvar FloatingWindow = function (props) {\n  var title = props.title,\n      id = props.id,\n      url = props.url,\n      rect = props.rect,\n      onCloseWindow = props.onCloseWindow,\n      onSetWindow = props.onSetWindow,\n      children = props.children;\n  var popoutWindow = React.useRef(null);\n\n  var _a = React.useState(undefined),\n      content = _a[0],\n      setContent = _a[1];\n\n  React.useLayoutEffect(function () {\n    var r = rect; // Make a local copy of the styles from the current window which will be passed into\n    // the floating window. window.document.styleSheets is mutable and we can't guarantee\n    // the styles will exist when 'popoutWindow.load' is called below.\n\n    var styles = Array.from(window.document.styleSheets).reduce(function (result, styleSheet) {\n      var rules = undefined;\n\n      try {\n        rules = styleSheet.cssRules;\n      } catch (e) {// styleSheet.cssRules can throw security exception\n      }\n\n      try {\n        return __spreadArray(__spreadArray([], result, true), [{\n          href: styleSheet.href,\n          type: styleSheet.type,\n          rules: rules ? Array.from(rules).map(function (rule) {\n            return rule.cssText;\n          }) : null\n        }], false);\n      } catch (e) {\n        return result;\n      }\n    }, []);\n    popoutWindow.current = window.open(url, id, \"left=\".concat(r.x, \",top=\").concat(r.y, \",width=\").concat(r.width, \",height=\").concat(r.height));\n\n    if (popoutWindow.current !== null) {\n      onSetWindow(id, popoutWindow.current); // listen for parent unloading to remove all popouts\n\n      window.addEventListener(\"beforeunload\", function () {\n        if (popoutWindow.current) {\n          popoutWindow.current.close();\n          popoutWindow.current = null;\n        }\n      });\n      popoutWindow.current.addEventListener(\"load\", function () {\n        var popoutDocument = popoutWindow.current.document;\n        popoutDocument.title = title;\n        var popoutContent = popoutDocument.createElement(\"div\");\n        popoutContent.className = Types_1.CLASSES.FLEXLAYOUT__FLOATING_WINDOW_CONTENT;\n        popoutDocument.body.appendChild(popoutContent);\n        copyStyles(popoutDocument, styles).then(function () {\n          setContent(popoutContent);\n        }); // listen for popout unloading (needs to be after load for safari)\n\n        popoutWindow.current.addEventListener(\"beforeunload\", function () {\n          onCloseWindow(id);\n        });\n      });\n    } else {\n      console.warn(\"Unable to open window \".concat(url));\n      onCloseWindow(id);\n    }\n\n    return function () {\n      // delay so refresh will close window\n      setTimeout(function () {\n        if (popoutWindow.current) {\n          popoutWindow.current.close();\n          popoutWindow.current = null;\n        }\n      }, 0);\n    };\n  }, []);\n\n  if (content !== undefined) {\n    return (0, react_dom_1.createPortal)(children, content);\n  } else {\n    return null;\n  }\n};\n\nexports.FloatingWindow = FloatingWindow;\n/** @internal */\n\nfunction copyStyles(doc, styleSheets) {\n  var head = doc.head;\n  var promises = [];\n\n  var _loop_1 = function (styleSheet) {\n    if (styleSheet.href) {\n      // prefer links since they will keep paths to images etc\n      var styleElement_1 = doc.createElement(\"link\");\n      styleElement_1.type = styleSheet.type;\n      styleElement_1.rel = \"stylesheet\";\n      styleElement_1.href = styleSheet.href;\n      head.appendChild(styleElement_1);\n      promises.push(new Promise(function (resolve, reject) {\n        styleElement_1.onload = function () {\n          return resolve(true);\n        };\n      }));\n    } else {\n      if (styleSheet.rules) {\n        var style = doc.createElement(\"style\");\n\n        for (var _a = 0, _b = styleSheet.rules; _a < _b.length; _a++) {\n          var rule = _b[_a];\n          style.appendChild(doc.createTextNode(rule));\n        }\n\n        head.appendChild(style);\n      }\n    }\n  };\n\n  for (var _i = 0, styleSheets_1 = styleSheets; _i < styleSheets_1.length; _i++) {\n    var styleSheet = styleSheets_1[_i];\n\n    _loop_1(styleSheet);\n  }\n\n  return Promise.all(promises);\n}","map":{"version":3,"mappings":"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","names":["FloatingWindow","props","id","url","rect","onCloseWindow","onSetWindow","children","popoutWindow","React","useRef","useState","undefined","content","setContent","useLayoutEffect","r","styles","Array","from","window","document","styleSheets","reduce","result","styleSheet","rules","cssRules","e","href","type","map","cssText","current","open","x","concat","y","width","height","addEventListener","close","popoutDocument","title","popoutContent","createElement","className","Types_1","FLEXLAYOUT__FLOATING_WINDOW_CONTENT","body","appendChild","copyStyles","then","console","warn","setTimeout","exports","doc","head","promises","styleElement_1","rel","push","Promise","resolve","reject","onload","style","_a","rule","createTextNode","_i","all"],"sources":["C:\\Users\\mmorrone\\UnityProjects\\my-app\\node_modules\\flexlayout-react\\src\\view\\FloatingWindow.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { Rect } from \"../Rect\";\nimport { CLASSES } from \"../Types\";\n\n/** @internal */\nexport interface IFloatingWindowProps {\n    title: string;\n    id: string;\n    url: string;\n    rect: Rect;\n    onCloseWindow: (id: string) => void;\n    onSetWindow: (id: string, window: Window) => void;\n}\n\ninterface IStyleSheet {\n    href: string | null;\n    type: string;\n    rules: string[] | null;\n}\n\n/** @internal */\nexport const FloatingWindow = (props: React.PropsWithChildren<IFloatingWindowProps>) => {\n    const { title, id, url, rect, onCloseWindow, onSetWindow, children } = props;\n    const popoutWindow = React.useRef<Window | null>(null);\n    const [content, setContent] = React.useState<HTMLElement | undefined>(undefined);\n\n    React.useLayoutEffect(() => {\n        const r = rect;\n        // Make a local copy of the styles from the current window which will be passed into\n        // the floating window. window.document.styleSheets is mutable and we can't guarantee\n        // the styles will exist when 'popoutWindow.load' is called below.\n        const styles = Array.from(window.document.styleSheets).reduce((result, styleSheet) => {\n            let rules: CSSRuleList | undefined = undefined;\n            try {\n                rules = styleSheet.cssRules;\n            } catch (e) {\n                // styleSheet.cssRules can throw security exception\n            }\n\n            try {\n                return [\n                    ...result,\n                    {\n                        href: styleSheet.href,\n                        type: styleSheet.type,\n                        rules: rules ? Array.from(rules).map(rule => rule.cssText) : null,\n                    }\n                ];\n            } catch (e) {\n                return result;\n            }\n        }, [] as IStyleSheet[]);\n        popoutWindow.current = window.open(url, id, `left=${r.x},top=${r.y},width=${r.width},height=${r.height}`);\n        if (popoutWindow.current !== null) {\n            onSetWindow(id, popoutWindow.current);\n\n            // listen for parent unloading to remove all popouts\n            window.addEventListener(\"beforeunload\", () => {\n                if (popoutWindow.current) {\n                    popoutWindow.current.close();\n                    popoutWindow.current = null;\n                }\n            });\n\n            popoutWindow.current.addEventListener(\"load\", () => {\n                const popoutDocument = popoutWindow.current!.document;\n                popoutDocument.title = title;\n                const popoutContent = popoutDocument.createElement(\"div\");\n                popoutContent.className = CLASSES.FLEXLAYOUT__FLOATING_WINDOW_CONTENT;\n                popoutDocument.body.appendChild(popoutContent);\n                copyStyles(popoutDocument, styles).then(() => {\n                    setContent(popoutContent);\n                });\n\n                // listen for popout unloading (needs to be after load for safari)\n                popoutWindow.current!.addEventListener(\"beforeunload\", () => {\n                    onCloseWindow(id);\n                });\n            });\n        } else {\n            console.warn(`Unable to open window ${url}`);\n            onCloseWindow(id);\n        }\n\n        return () => {\n            // delay so refresh will close window\n            setTimeout(() => {\n                if (popoutWindow.current) {\n                    popoutWindow.current.close();\n                    popoutWindow.current = null;\n                }\n            }, 0);\n        };\n    }, []);\n\n    if (content !== undefined) {\n        return createPortal(children, content!);\n    } else {\n        return null;\n    }\n};\n\n/** @internal */\nfunction copyStyles(doc: Document, styleSheets: IStyleSheet[]): Promise<boolean[]> {\n    const head = doc.head;\n    const promises: Promise<boolean>[] = [];\n    for (const styleSheet of styleSheets) {\n        if (styleSheet.href) {\n            // prefer links since they will keep paths to images etc\n            const styleElement = doc.createElement(\"link\");\n            styleElement.type = styleSheet.type;\n            styleElement.rel = \"stylesheet\";\n            styleElement.href = styleSheet.href!;\n            head.appendChild(styleElement);\n            promises.push(\n                new Promise((resolve, reject) => {\n                    styleElement.onload = () => resolve(true);\n                })\n            );\n        } else {\n            if (styleSheet.rules) {\n                const style = doc.createElement(\"style\");\n                for (const rule of styleSheet.rules) {\n                    style.appendChild(doc.createTextNode(rule));\n                }\n                head.appendChild(style);\n            }\n        }\n    }\n    return Promise.all(promises);\n}\n"]},"metadata":{},"sourceType":"script"}